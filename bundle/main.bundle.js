!function(e){function t(t){for(var r,i,c=t[0],s=t[1],l=t[2],u=0,m=[];u<c.length;u++)i=c[u],a[i]&&m.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(d&&d(t);m.length;)m.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={2:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/bundle/";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var d=s;o.push([83,0]),n()}({110:function(e,t){},113:function(e,t,n){"use strict";var r=n(3),a=n(114).rgb2hex,o=n(24),i=r("#background-color-modal"),c=r("#field").get(0),s=o.constructor.getDB();function l(){var e=a(r(c).css("background-color")),t=localStorage.getItem("bg-color-v1");r("#backgroundColorInput").val(t||e),t&&(c.style.backgroundColor=t),s.get("bg-image-v1").then(function(e){if(e){var t=window.URL.createObjectURL(e);c.style.backgroundSize=c.style.backgroundSize||"initial",c.style.backgroundImage="url("+t+")"}}),void 0!==localStorage.getItem("bg-repeat-v1")&&(c.style.backgroundRepeat=localStorage.getItem("bg-repeat-v1")?"repeat":"no-repeat",r("#backgroundRepeatInput").get(0).checked=JSON.parse(localStorage.getItem("bg-repeat-v1")),r("#backgroundImageRemoveButton").show()),void 0!==localStorage.getItem("bg-size-v1")&&(c.style.backgroundSize=localStorage.getItem("bg-size-v1"),r("#backgroundSizeSelect").val(localStorage.getItem("bg-size-v1")))}l(),i.find(".form").on("submit",function(e){return e.preventDefault()}),r("#backgroundRepeatInput").on("change",function(e){c.style.backgroundRepeat=e.target.checked?"repeat":"no-repeat",localStorage.setItem("bg-repeat-v1",e.target.checked)}),r("#backgroundSizeSelect").on("change",function(e){c.style.backgroundSize=e.target.value,localStorage.setItem("bg-size-v1",e.target.value)}),r("#backgroundImageRemoveButton").on("click",function(e){c.style.backgroundImage=null,s.delete("bg-image-v1"),r("#backgroundImageRemoveButton").hide()}),r("#backgroundImage").on("change",function(e){c.style.backgroundSize=c.style.backgroundSize||"initial",c.style.backgroundImage="url("+window.URL.createObjectURL(e.target.files[0])+")",s.set("bg-image-v1",e.target.files[0]),r("#backgroundImageRemoveButton").show()}),r("#backgroundColorInput").on("input",function(e){c.style.backgroundColor=e.target.value,localStorage.setItem("bg-color-v1",e.target.value)}),r("#backgroundResetButton").on("click",function(e){c.style.backgroundImage=null,c.style.backgroundColor=null,c.style.backgroundSize=null,c.style.backgroundRepeat=null,localStorage.removeItem("bg-color-v1"),localStorage.removeItem("bg-size-v1"),localStorage.removeItem("bg-repeat-v1"),s.delete("bg-image-v1"),l()})},114:function(e,t,n){"use strict";t.rgb2hex=function(e){if(/^#[0-9A-F]{6}$/i.test(e))return e;function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}return"#"+t((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+t(e[2])+t(e[3])}},115:function(e,t,n){"use strict";var r=n(3),a=n(35),o=n(116),i=n(117),c=n(154);console.log(o),r("#export-modal form").on("submit",function(e){e.preventDefault();var t=r("#mainh").val(),n=r("#field").get(0),s=new FormData(e.target);console.log(s);var l="on"===s.get("includeBackground");switch(console.log(l),s.get("format")){case"html":r("#field input, #field textarea").each(function(e){this.setAttribute("value",r(this).val())});var d=document.implementation.createHTMLDocument(t);r(d.body).append(r(n).clone(!1));var u=new i,m=(r(n).css("background-image")||"").replace(/url\(["']?/,"").replace(/["']?\);?/,""),p=m&&l?fetch(m).then(function(e){return e.blob()}):Promise.resolve(),b=o.replace("/bundle/",""),h=fetch(o).then(function(e){return e.blob()});Promise.all([fetch(r("#mmwindow-style").attr("href")),fetch(r("#mmelem-style").attr("href")),fetch("bundle/vendor.bundle.css"),fetch("bundle/main.bundle.css")].map(function(e){return e.then(function(e){return e.text()})})).then(function(e){var n=r(d).find("head").get(0);e.forEach(function(e){n.appendChild(d.createElement("style")).textContent=e.replace(o,b)}),p.then(function(e){if(m&&l){var n="background."+e.type.replace("image/","");u.file(n,e),d.body.style.backgroundImage='url("'+n+'")'}h.then(function(e){u.file(b,e);var n=(new XMLSerializer).serializeToString(d);u.file("index.html",n),u.generateAsync({type:"blob"}).then(function(e){a(e,t+".zip")})})})});break;default:var f=void 0;l||(f=n.getAttribute("style"),n.setAttribute("style","background-image: none; background-color: transparent")),c.toBlob(n).then(function(e){a(e,t+".png"),l||n.setAttribute("style",f)}).catch(function(e){l||n.setAttribute("style",f),console.error(e),alert("Error: ",e)})}return!1})},120:function(e,t){},122:function(e,t){},14:function(e,t,n){"use strict";var r=n(3);t.ContainsItem=function(e,t){for(var n=0;n<e.length;n++){if(e[n]===t)return!0;for(var r in e[n])if(e[n].hasOwnProperty(r))return!0}return!1},t.GetMiddleOfElement=function(e){var t=r(e).outerWidth(),n=r(e).outerHeight(),a=r(e).get(0).offsetLeft,o=r(e).get(0).offsetTop;return{x:parseInt(a+t/2),y:parseInt(o+n/2)}},t.GetLeftMiddle=function(e){r(e).outerWidth();var t=r(e).outerHeight(),n=r(e).get(0).offsetLeft,a=r(e).get(0).offsetTop;return{x:parseInt(n),y:parseInt(a+t/2)}},t.GetRightMidle=function(e){var t=r(e).outerWidth(),n=r(e).outerHeight(),a=r(e).get(0).offsetLeft,o=r(e).get(0).offsetTop;return{x:parseInt(a+t),y:parseInt(o+n/2)}},t.GetColor=function(e){var t=e.toString().match(/\((.+)\)/)[1];return[parseInt(t.split(",")[0].trim()),parseInt(t.split(",")[1].trim()),parseInt(t.split(",")[2].trim())]},t.rgbToHex=function(e){if("number"!=typeof e[0])throw Error("input of rgbToHex function must be an array of integers");return"#"+(e[0].toString(16)+e[1].toString(16)+e[2].toString(16)).toUpperCase()},t.GetColorOrUndefined=function(e){return e?(void 0).GetColor(e):void 0},t.debounce=function(e,t,n){var r;return function(){var a=this,o=arguments,i=n&&!r;clearTimeout(r),r=setTimeout(function(){r=null,n||e.apply(a,o)},t),i&&e.apply(a,o)}},t.throttle=function(e,t,n){var r;return function(){var a=this,o=arguments,i=n&&!r;r||(r=setTimeout(function(){r=null,n||e.apply(a,o)},t)),i&&e.apply(a,o)}}},15:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=n(14),o=n(3),i=n(19).EventEmitter,c=t.globalelems=[],s=t.globallines=[],l=n(14).throttle,d=n(85),u=t.elementType={LARGE:0,MIDDLE:1,SMALL:2,IMAGE:3},m=!0;t.getSaved=function(){return m},t.setSaved=function(){return m=!0};var p=window.globalelemnsHashed=t.globalelemnsHashed={},b=window.globallinesHashed=t.globallinesHashed={},h=!1;o(window).on("mousedown",function(){return h=!0}),o(window).on("mouseup",function(){return h=!1});var f=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=o("#field"),r=function(e){var t=e.target.value,n=o(e.target).parent(".mmelem").attr("data-key");v("elem_modified",{key:n,content:t})};n.on("input",".mmelem textarea",r),n.on("input",".mmelem input",r);var a=function(e){var t=o(e.target).outerWidth(),n=o(e.target).outerHeight(),r=c.map(function(e){return e[0]}).indexOf(o(e.target).closest(".mmelem")[0]),a=o(e.target).attr("data-key");v("elem_modified",{key:a,width:t,height:n}),c[r].UpdateAllConnectedLines()};return o(window).on("mousemove",function(e){h&&o(e.target).is(".mmelem textarea")&&a(e)}),n.on("mouseup",".mmelem textarea",a),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i),t}(),g=t.field=new f,v=l(function(e,t){return g.emit(e,t)},40);function w(){window.currdrag.diddrag=!1;var e=window.currdrag.line;o(e).remove(),window.currdrag=void 0}function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=void 0;switch(e){case 0:i='\n            <div class="mmelem mmmain">\n            <input class="mm_title" type="text" name="title" value="new title">\n            <button class="mmclose" type="button"></button>            \n            </div>';break;case 1:i='\n            <div class="mmelem mmheader">\n            <input class="mm_title" type="text" name="title" value="new title">\n            <button class="mmclose" type="button"></button>            \n            </div>';break;case 2:i='\n            <div class="mmelem mmnote">\n            <textarea name="textarea" style:"width:100px;height:60px;" class="mmcontent"></textarea>\n            <button class="mmclose" type="button"></button>            \n            </div>';break;case 3:i='<div class="mmelem mmimage">\n            <img alt="Mindmapper media node" src="https://via.placeholder.com/150">\n            <button class="mmclose" type="button"></button>            \n            </div>';break;default:i='\n            <div class="mmelem mmheader">\n            <input class="mm_title" type="text" name="title" value="new title">\n            <button class="mmclose" type="button"></button>            \n            </div>'}var l=document.getElementById("field");l.insertAdjacentHTML("beforeend",i);var f=l.lastChild,g=o(f);f.jqeurydata=g,o(g).attr("data-key",t),o(g).find("textarea").on("click",function(e){return e.stopPropagation()}),c.push(g),p[t]=g,f.childNodes.forEach(function(e){e.onmousedown=function(e){h=!0,e.stopPropagation()},o(e).is("textarea")&&(e.onwheel=function(){return!1})},this),o(g).css("top",80+Math.floor(20*Math.random())+"px"),o(g).css("left",80+Math.floor(20*Math.random())+"px"),g.mmdata={name:"newelem",connected_elems:[],containsElem:function(e){for(var t=0;t<g.mmdata.connected_elems.length;t++)if(g.mmdata.connected_elems[t].elem==e)return!0;return!1}},g.mousedown(function(e){if(e.stopPropagation(),window.activeElem=g,void 0!==window.currdrag){if(window.currdrag,window.currdrag==g)return console.log("dragged a line to itself"),o(window).mouseup(),void w();if(window.currdrag.mmdata.containsElem(g)||g.mmdata.containsElem(window.currdrag))return console.log("already dragged a line between these nodes"),o(window).mouseup(),void w();var t=window.currdrag.line;t.setAttribute("class","genline");var n=a.GetMiddleOfElement(g);t.setAttribute("d",k(t,"x2",n.x,0,0)),t.setAttribute("d",k(t,"y2",n.y,0,0)),t.connected_elems={elem1:g,elem2:window.currdrag},window.currdrag.mmdata.connected_elems.push({elem:g,line:t}),g.mmdata.connected_elems.push({elem:window.currdrag,line:window.currdrag.line}),window.currdrag.mmdata.connected_elems.forEach(function(e){window.currdrag.UpdateConnectedLines(e)}),g.mmdata.connected_elems.forEach(function(e){g.UpdateConnectedLines(e)}),s.push(t);var r=Math.random().toString(36);return o(t).attr("data-key",r),b[r]=t,v("line_created",{strokewidth:o(t).css("strokeWidth"),strokecolor:o(t).css("strokeColor"),key1:o(g).attr("data-key"),key2:o(window.currdrag).attr("data-key"),key:r}),void(window.currdrag=void 0)}var i=g.css("left").replace("px","")-e.pageX,c=g.css("top").replace("px","")-e.pageY;g.diddrag=!1,o(document).on("mousemove.elem-move",function(t){var n=t.pageX+i,r=t.pageY+c;g.css("top",r),g.css("left",n),g.mmdata.connected_elems.forEach(function(e){g.UpdateConnectedLines(e)});var a=o(g).attr("data-key");v("elem_modified",{leftpos:n,toppos:r,key:a}),(Math.abs(e.pageX-t.pageX)>5||Math.abs(e.pageY-t.pageY)>5)&&(g.diddrag=!0)})}),g.UpdateAllConnectedLines=function(){g.mmdata.connected_elems.forEach(function(e){g.UpdateConnectedLines(e)})},g.UpdateConnectedLines=function(e){var t=e.line,n=e.line.connected_elems.elem1,r=e.line.connected_elems.elem2;if(n===g){var a=_(n,e.elem),o=j(n,e.elem,400);t.setAttribute("d",k(t,"x2",a.x,o.x,o.y)),t.setAttribute("d",k(t,"y2",a.y,o.x,o.y)),a=_(e.elem,n),o=j(e.elem,n,400),t.setAttribute("d",k(t,"x1",a.x,o.x,o.y)),t.setAttribute("d",k(t,"y1",a.y,o.x,o.y))}else{if(r!==g)throw Error("element contains a line which doesnt hold a reference to that line.");var i=_(r,e.elem),c=j(r,e.elem,400);t.setAttribute("d",k(t,"x1",i.x,c.x,c.y)),t.setAttribute("d",k(t,"y1",i.y,c.x,c.y)),i=_(e.elem,r),c=j(e.elem,r,400),t.setAttribute("d",k(t,"x2",i.x,c.x,c.y)),t.setAttribute("d",k(t,"y2",i.y,c.x,c.y))}},g.click(function(e){if(e.stopPropagation(),0==g.diddrag){var t=a.GetMiddleOfElement(g),n=o("#svg_wrapper"),r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d","M282,143 C151,140 395,421 271,415"),r.setAttribute("d",k(r,"x1",t.x,0,0)),r.setAttribute("d",k(r,"y1",t.y,0,0)),r.setAttribute("d",k(r,"x2",t.x,0,0)),r.setAttribute("d",k(r,"y2",t.y,0,0)),r.setAttribute("class","pregenline"),r.ChangeWidth=function(e){var t=e.wheelDelta;t/=Math.abs(t);var n=parseInt(o(r).css("stroke-width").replace("px",""),10);n>=10&&t>0?t=0:n<=2&&t<0&&(t=0),o(r).css("stroke-width",n+t+"px")},o(r).mouseenter(function(){}),o(r).mouseleave(function(){}),o(r).click(function(){A(r,!0)}),o(r).mouseover(function(){window.activeElem=r}),n.append(r),g.line=r,window.currdrag=g,o(document).on("mousemove.elem-move",function(e){var t=e.pageX+l.scrollLeft,n=e.pageY+l.scrollTop;r.setAttribute("d",k(r,"x2",t,0,0)),r.setAttribute("d",k(r,"y2",n,0,0)),g.diddrag=!0})}}),o(g).on("click","img",function(e){d.open(o(g).get(0))}),g.RemoveThis=function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g.mmdata.connected_elems.length>0;)A(g.mmdata.connected_elems[g.mmdata.connected_elems.length-1].line);c.splice(c.indexOf(g),1);var t=o(g).attr("data-key");delete p[t],o(g).remove(),e&&v("elem_removed",{key:t})},o(g).children(".mmclose").click(function(){g.RemoveThis(!0)}),g.ChangeSize=function(t){var n,r=parseFloat(o(g).outerWidth()),a=parseFloat(o(g).outerHeight());switch(t=t/Math.abs(t)*8,e){case u.LARGE:(n=parseFloat(o(g).children(".mm_title").css("font-size").replace("em","")))<10&&t<0?t=0:n>200&&t>0&&(t=0),o(g).children(".mm_title").css("font-size",n+t/4);break;case u.IMAGE:var i=o(g).find("img");i.attr("width",i.width()*(1+t/40));break;case u.MIDDLE:(n=parseFloat(o(g).children(".mm_title").css("font-size").replace("em","")))<10&&t<0?t=0:n>140&&t>0&&(t=0),o(g).children(".mm_title").css("font-size",n+t/4);break;case u.SMALL:var s=o(g).children("textarea").css("width"),l=o(g).children("textarea").css("height");(n=parseFloat(o(g).children("textarea").css("font-size").replace("em","")))<10&&t<0?t=0:n>80&&t>0&&(t=0),o(g).children("textarea").css("font-size",n+t/4),o(g).children("textarea").css("width",s),o(g).children("textarea").css("height",l);break;default:var d=parseInt(o(g).css("width").replace("px",""),10),m=parseInt(o(g).css("height").replace("px",""),10);o(g).css("width",d+t+"px"),o(g).css("height",m+t+"px")}var p=+o(g).css("left").replace("px",""),b=+o(g).css("top").replace("px",""),h=(r-parseFloat(o(g).outerWidth()))/2,f=(a-parseFloat(o(g).outerHeight()))/2;o(g).css("left",p+h+"px"),o(g).css("top",b+f+"px"),g.UpdateAllConnectedLines();c.map(function(e){return e[0]}).indexOf(g[0]);var w=o(g).attr("data-key");v("elem_modified",{key:w,"font-size":n,leftpos:p+h,toppos:b+f})},g.onElemScroll=function(e){g.ChangeSize(e.wheelDelta)},o(g).mouseenter(function(){window.addEventListener("mousewheel",g.onElemScroll)}),o(g).mouseleave(function(){window.removeEventListener("mousewheel",g.onElemScroll,!1)}),g.UpdateMMdata=function(e){e.mmdata.connected_elems.push({elem:window.currdrag,line:window.currdrag.line})};var O,y=+o(g).css("left").replace("px",""),x=+o(g).css("top").replace("px","");n&&v("elem_created",(r(O={key:t,leftpos:y,toppos:x,type:e},"key",t),r(O,"content",g.find("input, textarea").val()),O));return m=!1,{elem:g,updatemmdata:g.UpdateMMdata}}function _(e,t){var n=a.GetLeftMiddle(e),r=a.GetRightMidle(e),o=a.GetLeftMiddle(t),i=a.GetRightMidle(t);return n.x>i.x?n:r.x<o.x?r:a.GetMiddleOfElement(e)}function j(e,t,n){var r=a.GetMiddleOfElement(e),o=a.GetLeftMiddle(e),i=a.GetRightMidle(e),c=a.GetMiddleOfElement(t),s=a.GetLeftMiddle(t),l=a.GetRightMidle(t);return o.x>l.x?{x:-(y(o,l)<n?y(o,l):n)/3,y:0}:i.x<s.x?{x:(y(i,s)<n?y(i,s):n)/3,y:0}:o.y<s.y?{x:0,y:(y(r,c)<n?y(r,c):n)/3}:{x:0,y:-(y(c,r)<n?y(c,r):n)/3}}function y(e,t){return Math.sqrt(Math.pow(Math.abs(parseInt(e.x)-parseInt(t.x,10)),2)+Math.pow(Math.abs(parseInt(e.y)-parseInt(t.y,10)),2))}function k(e,t,n,r,a){var o,i=e.getAttribute("d").split(/\s+/);if("x1"==t){var c=i[0].split(/,\s?/);c[0]=parseInt(c[0].replace(/[MC]/i,""),10),c[1]=parseInt(c[1],10),i[0]="M"+n+","+c[1],i[1]="C"+(n+r)+","+(c[1]+a),o=i.join(" ")}else if("y1"==t){var s=i[0].split(/,\s?/);s[0]=parseInt(s[0].replace(/[MC]/i,""),10),s[1]=parseInt(s[1],10),i[0]="M"+s[0]+","+n,i[1]="C"+(s[0]+r)+","+(n+a),o=i.join(" ")}else if("x2"==t){var l=i[3].split(/,\s?/);l[0]=parseInt(l[0],10),l[1]=parseInt(l[1],10),i[3]=n+","+l[1],i[2]=n+r+","+(l[1]+a),o=i.join(" ")}else if("y2"==t){var d=i[3].split(/,\s?/);d[0]=parseInt(d[0],10),d[1]=parseInt(d[1],10),i[3]=d[0]+","+n,i[2]=d[0]+r+","+(n+a),o=i.join(" ")}return o}function A(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=e.connected_elems||null!=e.connected_elems){for(var n=e.connected_elems.elem1.mmdata.connected_elems,r=0;r<n.length;r++)if(n[r].line===e){n.splice(r,1);break}for(var a=e.connected_elems.elem2.mmdata.connected_elems,i=0;i<a.length;i++)if(a[i].line===e){a.splice(i,1);break}}s.splice(s.indexOf(e),1),delete b[o(e).attr("data-key")],o(e).remove(),console.log("remove line",e),t&&v("line_removed",{key:o(e).attr("data-key")}),m=!1}t.RemoveAll=function(){for(var e in s.length=0,c.length=0,p)p.hasOwnProperty(e)&&delete p[e];for(var t in b)b.hasOwnProperty(t)&&delete b[t];o("svg").empty(),o("#field").children(".mmelem").remove(),m=!1},t.CreateElement=function(e){var t=e.type,n=e.leftpos,r=e.toppos,a=e.fontsize,i=e.backgroundcolor,c=e.content,s=(e.boxshadowcol,e.width),l=e.height,d=O(t,e.key).elem;return o(d).css("left",n),o(d).css("top",r),o(d).children("textarea").css("font-size",a),o(d).children("textarea").css("width",s),o(d).children("textarea").css("height",l),o(d).children("textarea").val(c),o(d).children("textarea").on("click",function(e){return e.stopPropagation()}),o(d).children("input").on("click",function(e){return e.stopPropagation()}),o(d).children("input").css("font-size",a),o(d).children("input").val(c),o(d).find("img").attr("width",(s||"").replace("px","")),o(d).find("img").attr("src",c),void 0!==i&&o(d).css("background-color",i),m=!1,d},t.CreateLine=function(e,t,n,r,i){var c=n,l=a.GetMiddleOfElement(c),d=o("#svg_wrapper"),u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d","M282,143 C151,140 395,421 271,415"),u.setAttribute("d",k(u,"x1",l.x,0,0)),u.setAttribute("d",k(u,"y1",l.y,0,0)),u.setAttribute("d",k(u,"x2",l.x,0,0)),u.setAttribute("d",k(u,"y2",l.y,0,0)),u.setAttribute("class","genline"),u.ChangeWidth=function(e){var t=e.wheelDelta;t/=Math.abs(t);var n=+(o(u)[0].style["stroke-width"]||"3").replace("px","");n>=10&&t>0?t=0:n<=2&&t<0&&(t=0),o(u).css("stroke-width",n+t+"px")},o(u).mouseenter(function(){}),o(u).mouseleave(function(){}),o(u).click(function(){A(u,!0)}),o(u).mouseover(function(){window.activeElem=u}),d.append(u),c=r;var p=a.GetMiddleOfElement(c);u.setAttribute("d",k(u,"x2",p.x,0,0)),u.setAttribute("d",k(u,"y2",p.y,0,0)),u.connected_elems={elem1:n,elem2:r},n.mmdata.connected_elems.push({elem:r,line:u}),r.mmdata.connected_elems.push({elem:n,line:u}),n.mmdata.connected_elems.forEach(function(e){n.UpdateConnectedLines(e)}),r.mmdata.connected_elems.forEach(function(e){r.UpdateConnectedLines(e)}),s.push(u),o(u).attr("data-key",i),b[i]=u,e&&o(u).css("stroke-width",e),t&&o(u).css("stroke-color","rgb( "+t.join()+")"),m=!1},o(document).ready(function(){O(0,Math.random().toString(36)),o(document).click(function(){o("#color-picker").css("display","none")}),o(document).mouseup(function(){void 0!==window.currdrag&&w(),o(document).unbind("mousemove.elem-move")}),o("#spawn_elem_btn0").click(function(){var e=Math.random().toString(36);O(u.LARGE,e,!0)}),o("#spawn_elem_btn1").click(function(){var e=Math.random().toString(36);O(u.MIDDLE,e,!0)}),o("#spawn_elem_btn2").click(function(){var e=Math.random().toString(36);O(u.SMALL,e,!0)}),o("#spawn_elem_btn3").click(function(){var e=Math.random().toString(36);O(u.IMAGE,e,!0)}),o("#color-picker").click(function(e){e.stopPropagation()});var e=document.getElementById("color-picker");e.GetColor=function(e){return a.GetColor(o(e).css("background-color").toString())},e.GetColorHex=function(t){var n=e.GetColor(t);return a.rgbToHex(n)},e.AssignColorSlider=function(t){if(window.activeElem){var n=255,r=255,i=255;if(0==t.trim().startsWith("#"))n=parseInt(o("#color-picker").children("#red").val(),10),r=parseInt(o("#color-picker").children("#green").val(),10),i=parseInt(o("#color-picker").children("#blue").val(),10),o("#color-picker").children("#hex").val(a.rgbToHex([n,r,i]));else{if(1!=/^#([\da-z]{6})$/i.test(t.trim()))throw Error("the function is unclear about this argument: "+t);var c=t.trim().match(/^#([\da-z]{6})$/i)[1];n=parseInt(c.slice(0,2),16),r=parseInt(c.slice(2,4),16),i=parseInt(c.slice(4,6),16),o("#color-picker").children("#red").val(n),o("#color-picker").children("#green").val(r),o("#color-picker").children("#blue").val(i)}if("none"!=o(window.activeElem).css("box-shadow")){var s=o(window.activeElem).css("box-shadow");if(!window.activeElem.shadowOffset){var l=e.GetColor(window.activeElem),d=a.GetColor(s),u=[d[0]-l[0],d[1]-l[1],d[2]-l[2]];window.activeElem.shadowOffset=u}d=[n+(u=window.activeElem.shadowOffset)[0],r+u[1],i+u[2]],o(window.activeElem).css("box-shadow",s.replace(/\(.+\)/,"("+d.join()+")"))}o(window.activeElem).css("background-color","rgb("+[n,r,i].join()+")")}},e.childNodes.forEach(function(t){t.oninput=function(){window.activeElem&&e.AssignColorSlider(o(t).val())}})}),t.removeLine=function(e){A(b[e])}},155:function(e,t,n){"use strict";n(156);var r=n(157).default,a=n(3),o=n(16),i=function(){var e="medium";"small"!==(e=e.toLowerCase())&&"large"!==e&&(e="medium");var t=encodeURIComponent(document.querySelector("meta[name=description]").getAttribute("content")),n=encodeURIComponent(a("#mainh").val()+" Mindmap"),o=encodeURIComponent(new window.URL(location.pathname+location.search,"https://mindmapper.esstudio.site").href);a("#sharing-modal .modal-body").append("Share using this url: <strong>"+decodeURIComponent(o)+"</strong>"),a("#sharing-modal .modal-body").append(r({title:n,description:t,url:o,imageUrl:"https://mindmapper.esstudio.site/public/img/mindmap.png",size:e}))};"true"===o.ispublic&&(window.addEventListener("load",function(e){window.requestIdleCallback?window.requestIdleCallback(i):i()}),a("#sharing-modal-opener").show())},156:function(e,t,n){},157:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return a});var r=n(0);function a(e={}){var t=Object(r.document_createDocumentFragment)(),n=Object(r.document_createElement)("div"),a=Object(r.document_createElement)("a");Object(r.setAttribute)(a,"class","resp-sharing-button__link"),Object(r.setAttribute)(a,"href","https://facebook.com/sharer/sharer.php?u="+e.url+"&picture="+e.imageUrl+"&name="+e.title+"&caption="+e.description),Object(r.setAttribute)(a,"target","_blank"),Object(r.setAttribute)(a,"aria-label","");var o=Object(r.document_createElement)("span");Object(r.setAttribute)(o,"class","resp-sharing-button resp-sharing-button--facebook resp-sharing-button--"+e.size);var i=Object(r.document_createElement)("span");Object(r.setAttribute)(i,"aria-hidden","true"),Object(r.setAttribute)(i,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(o,i);var c=Object(r.document_createElement)("span");Object(r.appendChild)(c,Object(r.document_createTextNode)("Facebook")),Object(r.appendChild)(o,c),Object(r.appendChild)(a,o),Object(r.appendChild)(n,a);var s=Object(r.document_createElement)("a");Object(r.setAttribute)(s,"class","resp-sharing-button__link"),Object(r.setAttribute)(s,"target","_blank"),Object(r.setAttribute)(s,"href","https://twitter.com/intent/tweet/?text="+e.title+"%0D%0A"+e.description+"&url="+e.url+"&image="+e.imageUrl),Object(r.setAttribute)(s,"aria-label","");var l=Object(r.document_createElement)("span");Object(r.setAttribute)(l,"class","resp-sharing-button resp-sharing-button--twitter resp-sharing-button--"+e.size);var d=Object(r.document_createElement)("span");Object(r.setAttribute)(d,"aria-hidden","true"),Object(r.setAttribute)(d,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(l,d);var u=Object(r.document_createElement)("span");Object(r.appendChild)(u,Object(r.document_createTextNode)("Twitter")),Object(r.appendChild)(l,u),Object(r.appendChild)(s,l),Object(r.appendChild)(n,s);var m=Object(r.document_createElement)("a");Object(r.setAttribute)(m,"class","resp-sharing-button__link"),Object(r.setAttribute)(m,"href","https://plus.google.com/share?url="+e.url+"&image="+e.imageUrl),Object(r.setAttribute)(m,"target","_blank"),Object(r.setAttribute)(m,"aria-label","");var p=Object(r.document_createElement)("span");Object(r.setAttribute)(p,"class","resp-sharing-button resp-sharing-button--google resp-sharing-button--"+e.size);var b=Object(r.document_createElement)("span");Object(r.setAttribute)(b,"aria-hidden","true"),Object(r.setAttribute)(b,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(p,b);var h=Object(r.document_createElement)("span");Object(r.appendChild)(h,Object(r.document_createTextNode)("Google+")),Object(r.appendChild)(p,h),Object(r.appendChild)(m,p),Object(r.appendChild)(n,m);var f=Object(r.document_createElement)("a");Object(r.setAttribute)(f,"class","resp-sharing-button__link"),Object(r.setAttribute)(f,"target","_blank"),Object(r.setAttribute)(f,"href","https://www.tumblr.com/widgets/share/tool?posttype=link&title="+e.title+"&caption="+e.description+"&image="+e.imageUrl+"&content="+e.url+"&canonicalUrl="+e.url+"&shareSource=tumblr_share_button"),Object(r.setAttribute)(f,"aria-label","");var g=Object(r.document_createElement)("span");Object(r.setAttribute)(g,"class","resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--"+e.size);var v=Object(r.document_createElement)("span");Object(r.setAttribute)(v,"aria-hidden","true"),Object(r.setAttribute)(v,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(g,v);var w=Object(r.document_createElement)("span");Object(r.appendChild)(w,Object(r.document_createTextNode)("Tumblr")),Object(r.appendChild)(g,w),Object(r.appendChild)(f,g),Object(r.appendChild)(n,f);var O=Object(r.document_createElement)("a");Object(r.setAttribute)(O,"class","resp-sharing-button__link"),Object(r.setAttribute)(O,"href","mailto:?subject="+e.title+"&body="+e.description+"%0D%0A"+e.url),Object(r.setAttribute)(O,"target","_blank"),Object(r.setAttribute)(O,"aria-label","");var _=Object(r.document_createElement)("span");Object(r.setAttribute)(_,"class","resp-sharing-button resp-sharing-button--email resp-sharing-button--"+e.size);var j=Object(r.document_createElement)("span");Object(r.setAttribute)(j,"aria-hidden","true"),Object(r.setAttribute)(j,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(_,j);var y=Object(r.document_createElement)("span");Object(r.appendChild)(y,Object(r.document_createTextNode)("E-Mail")),Object(r.appendChild)(_,y),Object(r.appendChild)(O,_),Object(r.appendChild)(n,O);var k=Object(r.document_createElement)("a");Object(r.setAttribute)(k,"class","resp-sharing-button__link"),Object(r.setAttribute)(k,"href","https://pinterest.com/pin/create/button/?url="+e.url+"&media="+e.imageUrl+"&description=="+e.title+"%0D%0A"+e.description+"&image="+e.imageUrl),Object(r.setAttribute)(k,"target","_blank"),Object(r.setAttribute)(k,"aria-label","");var A=Object(r.document_createElement)("span");Object(r.setAttribute)(A,"class","resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--"+e.size);var x=Object(r.document_createElement)("span");Object(r.setAttribute)(x,"aria-hidden","true"),Object(r.setAttribute)(x,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(A,x);var E=Object(r.document_createElement)("span");Object(r.appendChild)(E,Object(r.document_createTextNode)("Pinterest")),Object(r.appendChild)(A,E),Object(r.appendChild)(k,A),Object(r.appendChild)(n,k);var C=Object(r.document_createElement)("a");Object(r.setAttribute)(C,"class","resp-sharing-button__link"),Object(r.setAttribute)(C,"href","https://www.linkedin.com/shareArticle?mini=true&url="+e.url+"&title="+e.title+"&summary="+e.description+"&source="+e.url+"&image="+e.imageUrl),Object(r.setAttribute)(C,"target","_blank"),Object(r.setAttribute)(C,"aria-label","");var I=Object(r.document_createElement)("span");Object(r.setAttribute)(I,"class","resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--"+e.size);var S=Object(r.document_createElement)("span");Object(r.setAttribute)(S,"aria-hidden","true"),Object(r.setAttribute)(S,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(I,S);var M=Object(r.document_createElement)("span");Object(r.appendChild)(M,Object(r.document_createTextNode)("LinkedIn")),Object(r.appendChild)(I,M),Object(r.appendChild)(C,I),Object(r.appendChild)(n,C);var T=Object(r.document_createElement)("a");Object(r.setAttribute)(T,"class","resp-sharing-button__link"),Object(r.setAttribute)(T,"href","https://reddit.com/submit/?url="+e.url+"&title="+e.title),Object(r.setAttribute)(T,"target","_blank"),Object(r.setAttribute)(T,"aria-label","");var L=Object(r.document_createElement)("span");Object(r.setAttribute)(L,"class","resp-sharing-button resp-sharing-button--reddit resp-sharing-button--"+e.size);var U=Object(r.document_createElement)("span");Object(r.setAttribute)(U,"aria-hidden","true"),Object(r.setAttribute)(U,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(L,U);var z=Object(r.document_createElement)("span");Object(r.appendChild)(z,Object(r.document_createTextNode)("Reddit")),Object(r.appendChild)(L,z),Object(r.appendChild)(T,L),Object(r.appendChild)(n,T);var P=Object(r.document_createElement)("a");Object(r.setAttribute)(P,"class","resp-sharing-button__link"),Object(r.setAttribute)(P,"href","https://www.xing.com/app/user?op=share;url="+e.url+";title="+e.title+"&image="+e.imageUrl),Object(r.setAttribute)(P,"target","_blank"),Object(r.setAttribute)(P,"aria-label","");var R=Object(r.document_createElement)("span");Object(r.setAttribute)(R,"class","resp-sharing-button resp-sharing-button--xing resp-sharing-button--"+e.size);var D=Object(r.document_createElement)("span");Object(r.setAttribute)(D,"aria-hidden","true"),Object(r.setAttribute)(D,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(R,D);var G=Object(r.document_createElement)("span");Object(r.appendChild)(G,Object(r.document_createTextNode)("XING")),Object(r.appendChild)(R,G),Object(r.appendChild)(P,R),Object(r.appendChild)(n,P);var N=Object(r.document_createElement)("a");Object(r.setAttribute)(N,"class","resp-sharing-button__link"),Object(r.setAttribute)(N,"href","https://api.whatsapp.com/send?text="+e.description+"%20"+e.url+"&image="+e.imageUrl),Object(r.setAttribute)(N,"target","_blank"),Object(r.setAttribute)(N,"aria-label","");var H=Object(r.document_createElement)("span");Object(r.setAttribute)(H,"class","resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--"+e.size);var B=Object(r.document_createElement)("span");Object(r.setAttribute)(B,"aria-hidden","true"),Object(r.setAttribute)(B,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(H,B);var W=Object(r.document_createElement)("span");Object(r.appendChild)(W,Object(r.document_createTextNode)("WhatsApp")),Object(r.appendChild)(H,W),Object(r.appendChild)(N,H),Object(r.appendChild)(n,N);var F=Object(r.document_createElement)("a");Object(r.setAttribute)(F,"class","resp-sharing-button__link"),Object(r.setAttribute)(F,"href","https://news.ycombinator.com/submitlink?u="+e.url+"&t="+e.title+"%0D%0A"+e.description+"&image="+e.imageUrl),Object(r.setAttribute)(F,"target","_blank"),Object(r.setAttribute)(F,"aria-label","");var q=Object(r.document_createElement)("span");Object(r.setAttribute)(q,"class","resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--"+e.size);var Y=Object(r.document_createElement)("span");Object(r.setAttribute)(Y,"aria-hidden","true"),Object(r.setAttribute)(Y,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(q,Y);var X=Object(r.document_createElement)("span");Object(r.appendChild)(X,Object(r.document_createTextNode)("Hacker News")),Object(r.appendChild)(q,X),Object(r.appendChild)(F,q),Object(r.appendChild)(n,F);var J=Object(r.document_createElement)("a");Object(r.setAttribute)(J,"class","resp-sharing-button__link"),Object(r.setAttribute)(J,"href","http://vk.com/share.php?title="+e.title+"&url="+e.url+"&image="+e.imageUrl),Object(r.setAttribute)(J,"target","_blank"),Object(r.setAttribute)(J,"aria-label","");var Q=Object(r.document_createElement)("span");Object(r.setAttribute)(Q,"class","resp-sharing-button resp-sharing-button--vk resp-sharing-button--"+e.size);var $=Object(r.document_createElement)("span");Object(r.setAttribute)($,"aria-hidden","true"),Object(r.setAttribute)($,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(Q,$);var K=Object(r.document_createElement)("span");Object(r.appendChild)(K,Object(r.document_createTextNode)("VK")),Object(r.appendChild)(Q,K),Object(r.appendChild)(J,Q),Object(r.appendChild)(n,J);var V=Object(r.document_createElement)("a");Object(r.setAttribute)(V,"class","resp-sharing-button__link"),Object(r.setAttribute)(V,"href","https://telegram.me/share/url?text="+e.title+"%0D%0A"+e.description+"&url="+e.url+"&image="+e.imageUrl),Object(r.setAttribute)(V,"target","_blank"),Object(r.setAttribute)(V,"aria-label","");var Z=Object(r.document_createElement)("span");Object(r.setAttribute)(Z,"class","resp-sharing-button resp-sharing-button--telegram resp-sharing-button--"+e.size);var ee=Object(r.document_createElement)("span");Object(r.setAttribute)(ee,"aria-hidden","true"),Object(r.setAttribute)(ee,"class","resp-sharing-button__icon resp-sharing-button__icon--solidcircle"),Object(r.appendChild)(Z,ee);var te=Object(r.document_createElement)("span");return Object(r.appendChild)(te,Object(r.document_createTextNode)("Telegram")),Object(r.appendChild)(Z,te),Object(r.appendChild)(V,Z),Object(r.appendChild)(n,V),Object(r.appendChild)(t,n),t}},16:function(e,t,n){"use strict";var r=function(e,t){e=(e||window.location.href).split("?")[1]||"";for(var n,r={},a=e.split("&"),o=0;o<a.length;o++)n=a[o].split("="),(!t||n[0]&&n[1])&&(r[decodeURIComponent(n[0])]=decodeURIComponent(n[1]));return r}(null,!0),a=r.room,o=r.ispublic,i=r.name,c=r.id;e.exports={apiUrl:"https://api.esstudio.site/api/mindviewer-web",room:a,ispublic:o,name:i,id:c}},24:function(e,t,n){"use strict";var r=n(25),a=console.error;window.storageEstimateWrapper=function(){return"storage"in navigator&&"estimate"in navigator.storage?navigator.storage.estimate():"webkitTemporaryStorage"in navigator&&"queryUsageAndQuota"in navigator.webkitTemporaryStorage?new Promise(function(e,t){navigator.webkitTemporaryStorage.queryUsageAndQuota(function(t,n){e({usage:t,quota:n})},t)}):Promise.resolve({usage:NaN,quota:NaN})};var o=new r("data"),i=void 0,c=Promise.resolve(),s=function(){return new Promise(function(e,t){if(void 0!==i)e(i);else{var n=JSON.parse(localStorage.getItem("mindmaper-mindmaps-storage-v2")||"{}")||{},r=Object.keys(n).map(function(e){return o.get("mindmap-items-"+e).then(function(t){n[e]=t})});Promise.all(r).then(function(){e(i=n)}).catch(function(e){a(e),t()})}})},l=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.putMindmap=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return c=new Promise(function(n,r){(t?Promise.resolve():c).then(function(){return s()}).then(function(t){return t[e.static.id]=e,i=t,o.set("mindmap-items-"+e.static.id,e).then(function(){var e=function(e){var t={};return Object.keys(e).forEach(function(n){var r=e[n];t[n]={static:{name:r.static.name,timestamp:r.static.timestamp,id:r.static.id},type:r.type,room:r.room}}),t}(t);try{localStorage.setItem("mindmaper-mindmaps-storage-v2",JSON.stringify(e))}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||alert("Unable to store data because their is not enough space.")}n()})}).catch(function(e){a(e),n()})})},this.shouldWeakPut=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return c=new Promise(function(n,r){(t?Promise.resolve():c).then(function(){return s()}).then(function(t){var r=!t[e.static.id]||t[e.static.id].should_update_token!==e.should_update_token;n(r)}).catch(function(e){a(e),n(!0)})})},this.tryWeakPut=function(e){return c=new Promise(function(n,r){c.then(function(){return t.shouldWeakPut(e,!0)}).then(function(r){r?t.putMindmap(e,!0).then(function(){n(!0)}):n(!1)}).catch(n)})},this.getMindmaps=function(){return c=c.then(function(){return s()})},this.deleteMindmap=function(e){return t.deleteMindmapKey(e.static.id)},this.deleteMindmapKey=function(e){return c=new Promise(function(t,n){c.then(function(){return s()}).then(function(n){return o.delete("mindmap-items-"+e).then(function(){delete n[e],i=n;try{localStorage.setItem("mindmaper-mindmaps-storage-v2",JSON.stringify(i))}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||alert("Unable to store data because you've reached the maximum storage quota.")}t()})}).catch(t)})};try{localStorage.getItem("test")}catch(e){18===e.code&&alert("You've blocked mindmapper from settings cookies on the mindmaper website. We don't send cookies or use cookies, except for anonimized analytics. By blocking cookies you've also blocked the saving of mindmaps, bookmarks, favorites etc. You can read our privacy statement here: https://esstudio.site/privacy-policy",{title:"Crash"}),a(e)}};l.isFirstTimeAppOpening=function(){return!localStorage.getItem("mindmaper-mindmaps-storage-v2")},l.storageEstimateWrapper=function(){return(void 0).storageEstimateWrapper()},l.getDB=function(){return o},e.exports=new l},25:function(e,t,n){"use strict";var r,a;e.exports=(r=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a.call(this),this.name=t;var n=this;this.ready=new Promise(function(e,r){var a=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB).open(location.origin);a.onupgradeneeded=function(e){n.db=e.target.result,n.db.createObjectStore(t)},a.onsuccess=function(t){n.db=t.target.result,e()},a.onerror=function(e){n.db=e.target.result,r(e)}})},a=function(){var e=this;this.get=function(t){var n=e;return e.ready.then(function(){return new Promise(function(e,r){var a=n.getStore().get(t);a.onsuccess=function(t){e(t.target.result)},a.onerror=r})})},this.getStore=function(){var t=e.db.transaction([e.name],"readwrite");return t.onabort=function(e){var t,n,r;"QuotaExceededError"===e.target.error.name&&alert("Unable to store data because you've reached the maximum storage quota.",(r=!0,(n="cancelable")in(t={cancelable:!0})?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t))},t.objectStore(e.name)},this.set=function(t,n){return new Promise(function(r,a){return e.ready.then(function(){var o=e.getStore().put(n,t);o.onsuccess=function(e){r()},o.onerror=a})})},this.delete=function(t){return e.ready.then(function(){return new Promise(function(n,r){var a=e.getStore().delete(t);a.onsuccess=n,a.onerror=r})})},this.deleteDatabase=function(){window.indexedDB.deleteDatabase(location.origin)}},r)},29:function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=n(3),o=n(15),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"readData",value:function(e){o.RemoveAll(),document.getElementById("mainh").value=e.static.name;for(var t=e.elems,n=e.lines,r=[],i=0;i<t.length;i++){var c=o.CreateElement(t[i]);r[t[i].id]=c}for(var s=0;s<n.length;s++){var l=r[n[s].elem1],d=r[n[s].elem2];o.CreateLine(n[s]["stroke-width"],n[s]["stroke-color"],l,d,n[s].key)}a("#mainh").val(e.static.name)}}]),e}();e.exports=new i},30:function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=n(14),o=n(3),i=n(15),c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.typeToClass={mmmain:i.elementType.LARGE,mmheader:i.elementType.MIDDLE,mmnote:i.elementType.SMALL,mmimage:i.elementType.IMAGE},window.StateSave=this}return r(e,[{key:"compileState",value:function(e){var t=o(document.getElementById("mainh")).val(),n=i.globalelems,r=i.globallines,c=[],s=[];console.log(n),console.log(r);for(var l=0;l<n.length;l++)n[l].save_id=l;for(var d=0;d<r.length;d++)r[d].save_id=d;for(var u=0;u<n.length;u++){for(var m=n[u].mmdata.connected_elems,p=[],b=0;b<m.length;b++)if(void 0!==m[b].elem.save_id&&void 0!==m[b].line.save_id){var h={lineid:parseInt(m[b].line.save_id).toString(),elemid:parseInt(m[b].elem.save_id).toString()};p.push(h)}else console.error("one of the connected elements is null or undefined"+m[b].elem);var f,g=n[u].attr("class").trim().split(/\s+/)[1],v=this.typeToClass[g];f=v===i.elementType.IMAGE?{id:n[u].save_id,key:o(n[u]).attr("data-key"),type:v,leftpos:o(n[u]).css("left"),toppos:o(n[u]).css("top"),connected_elems:p,width:o(n[u]).find("img").width()+"px",content:o(n[u]).find("img").attr("src")}:{id:n[u].save_id,key:o(n[u]).attr("data-key"),type:v,leftpos:o(n[u]).css("left"),toppos:o(n[u]).css("top"),connected_elems:p,"font-size":o(n[u]).children(2==this.typeToClass[g]?"textarea":"input").css("font-size"),width:o(n[u]).children("textarea").css("width"),height:o(n[u]).children("textarea").css("height"),content:o(n[u]).children(2==this.typeToClass[g]?"textarea":"input").val()},c.push(f)}for(var w=0;w<r.length;w++){var O={id:r[w].save_id.toString(),key:o(n[w]).attr("data-key"),"stroke-width":o(r[w]).css("stroke-width"),"stroke-color":a.GetColorOrUndefined(o(r[w]).css("stroke-color")),elem1:r[w].connected_elems.elem1.save_id,elem2:r[w].connected_elems.elem2.save_id};s.push(O)}return{static:{name:t,id:e,timestamp:Date.now()},elems:c,lines:s}}}]),e}();e.exports=new c},43:function(e,t,n){"use strict";var r=n(3),a=n(44)(),o=n(30),i=n(16),c=n(29),s=n(45),l=(n(35),n(15)),d=n(24),u=new Date,m=r("#save-last"),p=r("#save-mm"),b=r("#save-to-storage");t.percistanceLoaded=!1;var h=function(){m.text(a.format(u))};setInterval(h,5e3),"false"===i.ispublic?(t.dataId=i.id||Math.random().toString(36),i.id?(d.getMindmaps().then(function(e){var t=e[i.id];t?c.readData(t):r("#fullscreen-loader").fadeOut()}),r("#fullscreen-loader").fadeOut()):(document.getElementById("mainh").value=i.name,r("#fullscreen-loader").fadeOut()),p.add(b).on("click",function(){var e=o.compileState(t.dataId);e.type="app_storage",d.putMindmap(e).then(function(){l.setSaved(),u=new Date,h(),i.id||(window.location.href=window.location.origin+"/mindmapper.html?ispublic=false&id="+t.dataId)})})):(r.get("https://api.myjson.com/bins/"+i.room,function(e,n,a){!1===s.gotHotData&&c.readData(e),t.percistanceLoaded=!0,t.dataId=e.static.id,s.socketReadyPromise.then(function(){r("#fullscreen-loader").fadeOut()})}),p.add(b).on("click",function(){f()}));var f=t.saveToJsonOnline=function(){d.putMindmap({type:"api_bin",room:i.room,static:{id:t.dataId,name:r("#mainh").val(),timestamp:Date.now()}}),r.ajax({type:"PUT",url:"https://api.myjson.com/bins/"+i.room,data:JSON.stringify(o.compileState(t.dataId)),async:!1,contentType:"application/json; charset=utf-8",dataType:"json",error:function(e,t,n){alert("unable to save mind map")},success:function(e,t,n){u=new Date,h(),l.setSaved()}})}},45:function(e,t,n){"use strict";var r=n(3),a=n(87),o=n(16),i=n(29),c=n(30),s=n(43),l=n(15),d=l.field,u=l.globalelemnsHashed,m=(l.globallinesHashed,l.CreateElement),p=l.CreateLine,b=l.removeLine,h=n(14),f=(h.debounce,h.throttle),g=r("#messages"),v=Math.random().toString(36),w=o.apiUrl+"/no-persist-open-chat",O=!0;t.gotHotData=!1,t.socketReadyPromise=new Promise(function(e,t){if("false"===o.ispublic)return e();var n=a.connect(w,{"connect timeout":5e3});n.on("connect",function(){n.emit("init",{room:o.room,nickname:v},function(t){if(!t)return console.error("Unable to connect");n.emit("msg",{type:"retrieve-mm"}),setTimeout(function(){return O=!1},4e3);var a=[],o=f(function(){0!==a.length&&(a.length>1?n.emit("msg",{type:"batched_updates",batched:a}):n.emit("msg",a[0]),a.splice(0,a.length))},40),i=function(e){a.push(e),o()};n.on("msg",function(e){"batched_updates"===e.type?e.batched.forEach(function(t){t.from=e.from,_(t,i)}):_(e,i)}),n.on("disconnected",function(e){console.log("disconnect",e),e.msg="User disconnected from the room.",x(e),r(y[e.from]).remove(),delete y[e.from]}),j(i),e()}),n.on("disconnect",function(){console.warn(" socket disconnect")})}),n.on("connect_error",function(){alert("connection failed")})});var _=function(e,n){if("chat"===e.type)x(e);else if("update"===e.type)A(e);else if("retrieve-mm"===e.type){if(!1===s.percistanceLoaded)return;n({type:"receive-mm",state:c.compileState(s.dataId)})}else if("receive-mm"===e.type){if(!O)return;O=!1;var r=e.state;i.readData(r),t.gotHotData=!0}},j=function(e){r("#mainh").on("input",function(t){e({type:"update",action:"staticupdate",patch:{name:t.target.value}})}),d.on("elem_modified",function(t){e({type:"update",action:"elem_modified",patch:t})}),d.on("elem_created",function(t){e({type:"update",action:"elem_created",patch:t})}),d.on("elem_removed",function(t){e({type:"update",action:"elem_removed",patch:t})}),d.on("line_created",function(t){e({type:"update",action:"line_created",patch:t})}),d.on("line_removed",function(t){e({type:"update",action:"line_removed",patch:t})}),r(document).on("mousemove",f(function(t){e({type:"update",action:"mouse",clientX:t.clientX,clientY:t.clientY})},40,!1))},y={},k=r("#mouses"),A=function(e){var t=e.patch;if("mouse"===e.action&&(y[e.from]||(console.log("disconnect",e),e.msg="User joined the room.",x(e),r(y[e.from]).remove(),delete y[e.from],y[e.from]=r('<div class="mouse-pos"></div>').appendTo(k)),y[e.from].css("top",e.clientY).css("left",e.clientX)),"elem_removed"===e.action){var n=t.key;u[n].RemoveThis()}else if("elem_modified"===e.action){var a=t.key;void 0!==t.content&&(console.log(u[a].get(0)),console.log(u[a].find("input, textarea")),u[a].find("input, textarea").val(t.content)),void 0!==t["font-size"]&&u[a].find("input, textarea").css("font-size",t["font-size"]),void 0!==t.leftpos&&(u[a].css("left",t.leftpos),u[a].UpdateAllConnectedLines()),void 0!==t.toppos&&(u[a].css("top",t.toppos),u[a].UpdateAllConnectedLines()),void 0!==t.width&&(u[a].find("textarea").outerWidth(t.width),u[a].UpdateAllConnectedLines()),void 0!==t.height&&(u[a].find("textarea").outerHeight(t.height),u[a].UpdateAllConnectedLines())}else"elem_created"===e.action?(m(t),console.log("created",e)):"line_created"===e.action?p(t.strokewidth,t.strokecolor,u[t.key1],u[t.key2],t.key):"line_removed"===e.action?b(t.key):"staticupdate"===e.action&&void 0!==t.name&&r("#mainh").val(t.name)};function x(e){var t=e.from,n=e.msg,r=(g.scrollTop(),g.innerHeight(),g[0].scrollHeight);r=g.scrollTop()+g.height();g.append('<div class="message other">    <div class="msg">'+n+'</div>    <div class="from">'+t+"</div>    </div>"),r>-1&&g.scrollTop(g[0].scrollHeight)}},83:function(e,t,n){"use strict";n(41);var r=n(3);window.jQuery=r,n(42),n(84),n(14);var a=n(15),o=(n(29),n(30),n(86),n(43)),i=(n(45),n(16));n(113),n(115),n(155),window.onbeforeunload=function(){if("false"===i.ispublic){if(!a.getSaved())return"You have unsaved progress. Are you sure you want to go back to the homepage?"}else o.saveToJsonOnline()},r("#btn-back-home").on("click",function(){window.location.href=window.location.origin+"/index.html"}),console.log(i.ispublic),"true"!==!i.ispublic&&r("#spawn_elem_btn3").show()},84:function(e,t,n){},85:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),a=(n(16),r("#node-image-select")),o=null,i=null,c=null,s=function(){i=null,c=null,o=null};r("#node-image-select-preview").attr("src",r(void 0).attr("src")),r("#node-image-select form").on("submit",function(e){return e.preventDefault(),console.log(i),o&&r(o).find("img").attr("src",i),!1}),r("#nodeImage").on("change.imagemodal",function(e){c=e.target.files[0],i=window.URL.createObjectURL(c),r("#node-image-select-preview").attr("src",i)}),a.on("hidden.bs.modal",function(){s()});t.open=function(e){o&&s(),o=e,a.modal().show(),r("#node-image-select-preview").attr("src",r(e).find("img").attr("src"))}},86:function(e,t,n){"use strict";var r=n(3),a=r("#choose-color-theme"),o=r("#choose-color-theme-options"),i=r("#mmelem-style"),c=r("#mmwindow-style"),s=window.localStorage&&window.localStorage.theme||"dark",l={dark:"#30303b",indian:"#E09f3e",light:"#8aa29e",matriks:"#00ff00",monokai:"#a6e22e",raster:"#c2fcf7",russian:"#420039",space:"#55c1cf"},d=function(){o.empty();var e=1;for(var t in l)if(l.hasOwnProperty(t)&&t!==s){var n=l[t];o.append('\n                <button class="option" data-color="'+n+'" data-name="'+t+'"\n                    style="left: '+60*e+++"px; background-color: "+n+'"></button>\n            ')}o.css("width",60*e),a.css("background-color",l[s])};d(),o.on("click","button.option",function(e){console.log(e.target),u(r(e.target).attr("data-name"))});var u=t.setColorTheme=function(e){s=e,d(),i.attr("href","styles/mmelemsstyle-"+s+".css"),c.attr("href","styles/mmwindow-"+s+".css"),window.localStorage&&(localStorage.theme=e)}}});